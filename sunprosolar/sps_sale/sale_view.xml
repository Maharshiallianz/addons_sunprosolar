<?xml version="1.0"?>
<openerp>
    <data>
        <record model="ir.ui.view" id="view_sale_order_form_inherited">
            <field name="name">sale.order.form.inherited</field>
            <field name="model">sale.order</field>
            <field name="inherit_id" ref="sale.view_order_form"/>
            <field name="arch" type="xml">
                <xpath expr="/form/header/button[@name='action_button_confirm']" position="attributes">
                     <attribute name="states">sent,contract_generated,contract_signed,site_inspection,progress</attribute>
				</xpath>
				<xpath expr="/form/header/button[@name='print_quotation']" position="attributes">
                     <attribute name="states">sent,contract_generated,contract_signed,site_inspection,progress</attribute>
				</xpath>
				
                <xpath expr="//form/header/field[@name='state']" position="replace">
                    <field name="state" widget="statusbar" statusbar_visible="draft,sent,contract_generated,contract_signed,site_inspection,progress" statusbar_colors='{"waiting_date":"blue"}'/>
                </xpath>
                <!-- 
                <xpath expr="//form/sheet/group/group[2]/field[3][@name='client_order_ref']" position="after">
                    <label for="contract_id" attrs="{'invisible':[('state','!=','sent')]}"/>
                    <div attrs="{'invisible':[('state','!=','sent')]}">
                        <field name="contract_id" colspan="2"/>
                        <button name="contract_sign" string="Contract Sign" colspan="2" type="object" icon="gtk-yes" />
                    </div>
                 </xpath>
                 -->
                 <xpath expr="//page[@string='Other Information']" position="after">
                     <page string="Contract Details"  attrs="{'invisible':[('state','!=','sent'),('state','!=','contract_generated'),('state','!=','contract_signed'),('state','!=','site_inspection')]}">
							 <label for="contract_id"/>
							<field name="contract_id" colspan="2"/>
							 <group attrs="{'invisible': [('contract_id','=',False)]}">
	                         	<button name="contract_generate" string="Generate Contract" colspan="2" type="object" icon="gtk-yes" attrs="{'invisible':[('state','!=','sent')]}"  />
	                         </group>
	                         <group attrs="{'invisible': [('contract_id','=',False)]}">
	                         <button name="contract_sign" string="Contract Sign" colspan="2" type="object" icon="gtk-yes" attrs="{'invisible':[('state','!=','contract_generated')]}"/>
	                         </group>
	                         <group attrs="{'invisible': [('contract_id','=',False)]}">
	                         <button name="site_inspection_mail" string="Email Project Mgt Team - New Site Inspection" colspan="2" type="object" icon="gtk-yes" attrs="{'invisible':[('state','!=','contract_signed')]}"/>
	                         </group>
                     </page>
                     <page string="Permit Design Data"  attrs="{'invisible':[('state','!=','site_inspection')]}">
                             <group col="4" colspan="4">
							 	<field name="engineering"/>
							 	<label for="confirm_original"/>
							 	<div>
								 	<field name="confirm_original"/>
								 	<button name="change_sent_customer" string="Changes sent to the Customer" colspan="2" type="object" icon="gtk-execute" attrs="{'invisible':[('confirm_original','!=','change')]}"  />
							 	</div>
							 </group>
                     </page>
                 </xpath>
             </field>
         </record>
         
		<record id="sale.action_quotations" model="ir.actions.act_window">
            <field name="name">Quotations</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">sale.order</field>
            <field name="view_type">form</field>
            <field name="view_id" ref="sale.view_quotation_tree"/>
            <field name="view_mode">tree,form,calendar,graph</field>
            <field name="context">{}</field>
            <field name="domain">[('state','in',('draft','sent','contract_generated','contract_signed','site_inspection','cancel'))]</field>
            <field name="search_view_id" ref="sale.view_sales_order_filter"/>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to create a quotation, the first step of a new sale.
              </p><p>
                OpenERP will help you handle efficiently the complete sale flow:
                from the quotation to the sales order, the
                delivery, the invoicing and the payment collection.
              </p><p>
                The social feature helps you organize discussions on each sales
                order, and allow your customers to keep track of the evolution
                of the sales order.
              </p>
            </field>
        </record>
        
		<record id="sale.action_orders" model="ir.actions.act_window">
            <field name="name">Sales Orders</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">sale.order</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form,calendar,graph</field>
            <field name="search_view_id" ref="sale.view_sales_order_filter"/>
            <field name="context">{}</field>
            <field name="domain">[('state','not in',('draft','sent','contract_generated','contract_signed','site_inspection','cancel'))]</field>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to create a quotation that can be converted into a sales
                order.
              </p><p>
                OpenERP will help you efficiently handle the complete sales flow:
                quotation, sales order, delivery, invoicing and payment.
              </p>
            </field>
        </record>
        
		<record model="ir.ui.view" id="account_analytic_form1">
			<field name="name">account.analytic.form</field>
			<field name="model">account.analytic.account</field>
			<field name="inherit_id" ref="analytic.view_account_analytic_account_form"/>
			<field name="arch" type="xml">
				<xpath expr="//form/sheet/notebook/page[@string='Contract Information']" position="after">
                    <page string="User Contract Info">
                        <group col="4" colspan="4">
	                         <field name="contract_id" />
	                         <field name="contract_date" />
	                         <field name="type_of_finance" />
	                         <field name="amount" />
	                         <field name="deposit" />
	                         <field name="planet" />
	                         <field name="power" attrs="{'invisible':[('planet','!=','ppa')]}"/>
                         </group>
                    </page>
					<page string="Project Team Members">
					     <field name="members" />
					</page>
				</xpath>
			</field>
		</record>
    </data>
</openerp>
